
<div id="container">
	<div id="console-wrapper">
		<div id="console">
		</div>
		<form id="input">
			<input id="msg" type="text" autocomplete="off"></input>
		</form>
	</div>
</div>


<style>
	body{
		padding:0;
		margin:0;
	}
	#container{
		position:absolute;
		top:0px;
		left:0px;
		right:0px;
		bottom:0px;
	}
	#console-wrapper{
		background:black;
		color:white;
		position:absolute;
		top:0px;
		bottom:0px;
		right:0px;
		left:0px;
	}
	#console{
		position:absolute;
		top:0px;
		bottom:0px;
		right:0px;
		left:0px;
		overflow:scroll;
		padding:6px;
	}
	#input{
		position:absolute;
		bottom:0px;
	}
	#input, #input input{
		width:100%;
		margin:0px;
	}
	#input input{
		background:black;
		border:1px solid gray;
		color:white;
		padding:4px;
	}
</style>
<script>
	var ws;
	document.addEventListener("DOMContentLoaded", function(event) { 
		var con = document.getElementById("console");
		var inp = document.getElementById("msg");

		ws = new WebSocket("ws://"+window.location.hostname+":8080");
		ws.onopen = function (event) {
		  	ws.send(JSON.stringify({
		  		action:"sub",
		  		channel:"global"
		  	})); 
		  	ws.onmessage = function (event) {
		  		var obj = JSON.parse(event.data);
			  	con.innerHTML = con.innerHTML+"#"+obj.channel+"> "+obj.message+"<br>";
			};
		};
		document.getElementById("input").onsubmit = function(){
			var m = JSON.stringify({
		  		action:"shout",
		  		channel:"global",
		  		message:inp.value
		  	});
			ws.send(m); 
		  	console.log(m);
			inp.value = "";
			return false;
		};
	});
</script>
